<!doctype html>
<html>
    <head>
        <title>buku</title>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no, viewport-fit=cover" />
        <meta name="theme-color" content="#ffffffE6" />
        <link rel="manifest" href="/manifest.json" />
        <script src="https://cdn.tailwindcss.com"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        fontFamily: {
                            'system': ['system-ui', 'sans-serif']
                        }
                    }
                }
            }
        </script>
    </head>
    <body class="font-system font-light bg-gray-50">
        <div id="app"></div>
        <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
        <script type="module" src="/js/app.js"></script>
        <script>
            // Register service worker
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('/sw.js')
                        .then(registration => {
                            console.log('SW registered: ', registration);
                            
                            // Check for updates
                            registration.addEventListener('updatefound', () => {
                                const newWorker = registration.installing;
                                newWorker.addEventListener('statechange', () => {
                                    if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                        // New content available
                                        window.dispatchEvent(new CustomEvent('sw-update-available', {
                                            detail: { registration }
                                        }));
                                    }
                                });
                            });
                        })
                        .catch(error => {
                            console.log('SW registration failed: ', error);
                        });
                    
                    // Listen for service worker messages
                    navigator.serviceWorker.addEventListener('message', event => {
                        if (event.data && event.data.type === 'SW_UPDATED') {
                            window.dispatchEvent(new CustomEvent('sw-updated'));
                        }
                    });
                });
            }
        </script>
    </body>
</html>